<div class="wrapper">

    <mat-form-field class="queries__filter">
        <mat-label>Filtro</mat-label>
        <mat-icon matPrefix class="queries__filter-icon">search</mat-icon>
        <input matInput (keyup)="applyFilter($event)" placeholder="Ingrese valor para filtrar" #input>
    </mat-form-field>

    <div class="sac-request-cross">

        <table mat-table #requestTable  [dataSource]="dataSource" multiTemplateDataRows  matSort>
            
            <ng-container matColumnDef="requestNumber">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Solicitud</th>
                <td mat-cell *matCellDef="let element">{{ element.requestNumber }}</td>
            </ng-container>
        
            <ng-container matColumnDef="requestDateTime">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Hora Solicitud</th>
                <td mat-cell *matCellDef="let element">{{ element.requestDateTime }}</td>
            </ng-container>
        
            <ng-container matColumnDef="requestingCompany">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Empresa Solicitante</th>
                <td mat-cell *matCellDef="let element">{{ element.requestingCompany }}</td>
            </ng-container>
        
            <ng-container matColumnDef="updatedCompany">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Empresa Actualizada</th>
                <td mat-cell *matCellDef="let element">{{ element.updatedCompany }}</td>
            </ng-container>
        
            <ng-container matColumnDef="sacAnalyst">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Analista SAC </th>
                <td mat-cell *matCellDef="let element">{{ element.sacAnalyst }}</td>
            </ng-container>

            <ng-container matColumnDef="lastUpdateDateTime">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Hora actualizaci√≥n</th>
                <td mat-cell *matCellDef="let element">{{ element.lastUpdateDateTime | date:'yyyy-MM-dd HH:mm:ss':'UTC' }}</td>
            </ng-container>

            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Estado</th>
                <td mat-cell *matCellDef="let element">
                    <div class="sac-request-cross__table-actions">
                        <ng-container *ngIf="element.status == '1Creada'">
                            <svg class="sac-request-cross__icon-x" id="Capa_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 413.24 413.24"><defs><style>.sync-1{fill:#777677;stroke-width:0px;}</style></defs><g id="Capa_1-2"><path class="sync-1" d="m380.58,143.21l-90.83-11.53c-6.62-.84-9.47-8.86-4.86-13.69l18.28-19.15c-26.66-18.06-60.17-28.85-96.55-28.85-71.89,0-130.18,61.04-130.3,136.4l-76.32-.06C.16,92.34,92.6,0,206.62,0c53.68,0,102.57,20.47,139.31,54.03l14.03-14.7c4.61-4.83,12.75-2.36,13.9,4.21l15.78,90.2c.94,5.4-3.61,10.16-9.05,9.47Z"/><path class="sync-1" d="m32.65,270.03l90.83,11.53c6.62.84,9.47,8.86,4.86,13.69l-18.28,19.15c26.66,18.06,60.17,28.85,96.55,28.85,71.89,0,130.18-61.04,130.3-136.4l76.32.06c-.16,113.97-92.6,206.32-206.62,206.32-53.68,0-102.57-20.47-139.31-54.03l-14.03,14.7c-4.61,4.83-12.75,2.36-13.9-4.21l-15.78-90.2c-.94-5.4,3.61-10.16,9.05-9.47Z"/></g></svg>
                        </ng-container>
                        
                        <ng-container *ngIf="element.status == '1CambioAprobado'">
                            <svg class="sac-request-cross__icon-x" id="Capa_2" version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 282.000000 300.000000" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none"> <path d="M643 2760 c-39 -23 -51 -46 -59 -105 l-7 -45 -84 0 c-83 0 -86 -1 -119 -34 -33 -33 -34 -37 -34 -110 0 -62 3 -78 16 -83 32 -12 49 11 54 76 3 40 10 65 20 71 9 6 220 9 540 7 l525 -2 1 -42 1 -43 -298 0 c-200 0 -306 -4 -323 -11 -35 -16 -49 -58 -44 -129 7 -99 -10 -94 350 -100 l312 -5 4 -40 c5 -56 26 -90 66 -109 28 -13 69 -16 230 -16 l196 0 0 -459 0 -458 -77 -5 c-154 -10 -280 -88 -212 -131 12 -7 30 -3 70 16 30 15 78 32 108 38 158 33 333 -56 408 -209 25 -51 28 -68 28 -157 0 -88 -3 -107 -27 -157 -35 -76 -104 -148 -175 -184 -53 -26 -67 -29 -163 -29 -93 0 -111 3 -162 27 -154 72 -243 247 -209 410 7 34 22 79 32 101 24 47 22 81 -7 85 -50 7 -104 -122 -104 -252 0 -98 17 -160 64 -238 l35 -58 -584 0 c-567 0 -585 1 -595 19 -7 13 -10 324 -10 939 0 990 2 953 -50 937 -20 -6 -20 -8 -20 -946 0 -1038 -4 -981 64 -1013 30 -14 101 -16 659 -16 l624 0 44 -24 c171 -96 394 -63 536 80 169 169 174 441 12 618 l-49 54 0 831 c0 913 3 874 -60 906 -25 13 -126 15 -762 15 -708 0 -734 -1 -765 -20z m1507 -79 c7 -13 10 -286 10 -816 l0 -796 -30 16 c-16 8 -36 15 -45 15 -13 0 -15 55 -15 497 l0 497 -257 258 -257 258 -448 0 -448 0 0 33 c0 18 5 38 12 45 9 9 187 12 740 12 709 0 728 0 738 -19z m-386 -559 c-114 -2 -171 1 -180 9 -11 9 -14 49 -14 183 l0 171 180 -180 180 -180 -166 -3z m-266 206 l-4 -43 -292 -3 -292 -2 0 45 0 45 296 0 295 0 -3 -42z"/> <path d="M2372 2505 c-17 -14 -36 -43 -42 -63 -8 -25 -10 -229 -8 -629 l3 -592 42 -43 c33 -34 42 -52 45 -83 2 -33 7 -41 27 -43 28 -4 41 12 41 53 0 23 11 41 40 70 l40 39 0 623 0 623 -28 31 c-23 25 -38 33 -78 36 -43 5 -54 2 -82 -22z m96 -61 c19 -13 22 -24 22 -90 l0 -74 -45 0 -45 0 0 72 c0 52 4 76 17 90 20 22 23 22 51 2z m22 -634 l0 -400 -45 0 -45 0 0 400 0 400 45 0 45 0 0 -400z m0 -513 c0 -33 -6 -49 -25 -67 -24 -23 -25 -23 -45 -5 -15 13 -20 31 -20 67 l0 48 45 0 45 0 0 -43z"/> <path d="M591 1931 c-7 -13 -7 -23 2 -35 11 -15 64 -16 611 -14 546 3 600 4 609 20 8 12 7 21 -2 32 -12 14 -78 16 -612 16 -573 0 -599 -1 -608 -19z"/> <path d="M597 1772 c-21 -23 -21 -27 -1 -46 14 -14 83 -16 608 -16 447 0 595 3 604 12 16 16 15 33 -4 52 -14 14 -82 16 -603 16 -557 0 -589 -1 -604 -18z"/> <path d="M591 1602 c-6 -11 -6 -24 0 -35 9 -16 53 -17 614 -17 600 0 604 0 610 20 16 51 27 50 -616 50 -563 0 -599 -1 -608 -18z"/> <path d="M1020 1448 c-23 -8 -26 -40 -6 -57 9 -8 70 -11 197 -9 l184 3 3 24 c2 13 -1 28 -7 34 -13 13 -338 17 -371 5z"/> <path d="M597 1192 c-21 -23 -21 -27 -1 -46 13 -13 45 -16 193 -16 183 0 201 4 201 42 0 32 -35 38 -208 38 -151 0 -171 -2 -185 -18z"/> <path d="M569 930 l-30 -30 3 -196 c4 -254 -17 -234 247 -234 261 0 241 -20 241 244 0 264 18 246 -240 246 l-192 0 -29 -30z m389 -217 l-3 -168 -167 -3 -168 -2 0 170 0 170 170 0 170 0 -2 -167z"/> <path d="M765 742 c-95 -50 -118 -79 -77 -101 16 -9 37 -2 109 34 102 50 122 68 106 93 -17 29 -45 23 -138 -26z"/> <path d="M2083 892 c-12 -2 -57 -34 -100 -72 l-78 -68 -39 29 c-60 44 -93 39 -150 -18 -49 -51 -62 -78 -51 -113 10 -33 211 -200 240 -200 18 0 65 36 163 122 75 66 143 128 150 136 26 32 14 77 -33 130 -46 51 -64 60 -102 54z m65 -148 c-7 -7 -64 -58 -127 -113 -98 -85 -117 -98 -131 -88 -40 28 -149 123 -149 129 -1 4 11 22 27 39 l27 31 45 -36 c25 -20 54 -36 66 -36 12 0 57 32 105 74 l84 75 33 -32 c26 -25 30 -34 20 -43z"/> </g> </svg>
                        </ng-container>
                        
                        <ng-container *ngIf="element.status == '8Rechazada'">
                            <svg class="sac-request-cross__icon-check" id="Capa_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 376.49 356.22"><defs><style>.cancel-1{fill:#333;stroke-width:0px;}</style></defs><g id="Capa_1-2"><path class="cancel-1" d="m355.39,23.21c-17.99-19.51-34.3-32.67-53.81-14.71L9.96,277.35c-19.51,17.99-7.35,35.16,10.64,54.68h0c17.99,19.52,35,33.99,54.51,15.99L366.72,79.18c19.52-17.99,6.66-36.46-11.33-55.97Z"/><path class="cancel-1" d="m21.1,23.21C39.09,3.71,55.4-9.46,74.91,8.5l291.62,268.85c19.51,17.99,7.35,35.16-10.64,54.68h0c-17.99,19.52-35,33.99-54.51,15.99L9.77,79.18C-9.76,61.19,3.11,42.72,21.1,23.21Z"/></g></svg>
                        </ng-container>
    
                        <ng-container *ngIf="element.status == '9Aprobada'">
                            <svg class="sac-request-cross__icon-check" id="Capa_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 85.81 67.12"><defs><style>.simple-check-1{fill:#333;}</style></defs><g id="Capa_1-2"><path class="simple-check-1" d="m81.34,4.92c-3.81-4.14-7.27-6.93-11.41-3.12L27.66,40.77l-10.67-12.21c-3.7-4.23-7.44-1.83-11.68,1.88-4.24,3.7-7.37,7.3-3.66,11.54l11.02,12.61,9,10.29c2.42,2.77,6.65,3,9.36.5l10.05-9.26,42.67-39.33c4.14-3.81,1.41-7.73-2.4-11.87Z"/></g></svg>
                        </ng-container>
    
                    </div>

                </td>
            </ng-container>
        
            <ng-container matColumnDef="documentsLinkIcon">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Docs</th>
                <td mat-cell *matCellDef="let element">
                    <div class="sac-request-cross__table-actions">
                        <ng-container *ngIf="element.documents.length > 0">
                            <a [href]="openDocumentsSelected(element.documents)" target="_blank">
                                <svg version="1.0" class="sac-request-cross__icon-check" id="Capa_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet"><g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none"> <path d="M935 5109 c-31 -18 -905 -891 -921 -921 -21 -40 -21 -906 0 -947 35 -66 137 -66 172 0 11 23 14 99 14 414 l0 385 320 0 c369 0 393 4 474 86 82 81 86 105 86 474 l0 320 1186 0 1186 0 34 -34 34 -34 0 -977 0 -978 -83 -86 c-137 -142 -204 -256 -249 -423 -28 -103 -30 -318 -5 -408 8 -30 15 -56 14 -57 -1 -1 -27 6 -57 14 -37 11 -100 16 -195 16 -167 0 -250 -18 -391 -88 l-90 -45 -223 0 -223 0 -34 -34 c-24 -25 -34 -43 -34 -66 0 -23 10 -41 34 -66 l34 -34 112 0 113 0 -104 -108 c-57 -59 -122 -134 -144 -167 -86 -130 -145 -321 -145 -471 0 -66 21 -220 36 -258 6 -15 -60 -16 -800 -16 -876 0 -848 -2 -874 55 -9 19 -12 242 -12 891 0 939 2 906 -55 932 -53 24 -114 4 -134 -45 -8 -21 -11 -259 -9 -918 3 -881 3 -890 24 -936 31 -66 78 -114 142 -146 l57 -28 881 -5 882 -5 46 -62 c244 -324 723 -427 1084 -232 107 57 169 109 343 285 210 214 270 307 321 496 28 103 30 318 5 408 -8 30 -15 56 -14 57 1 1 27 -5 57 -13 211 -55 474 -8 667 118 83 54 349 308 433 414 349 436 192 1095 -315 1325 -267 121 -591 97 -830 -60 l-60 -40 -5 902 c-5 835 -6 905 -23 941 -29 66 -83 123 -145 153 l-57 28 -1270 2 c-905 2 -1276 -1 -1290 -8z m-55 -575 l0 -236 -29 -29 -29 -29 -239 0 -238 0 265 265 c146 146 266 265 267 265 2 0 3 -106 3 -236z m3515 -1479 c39 -8 106 -32 150 -54 140 -70 236 -166 305 -306 108 -218 89 -467 -51 -672 -43 -64 -288 -313 -364 -370 -163 -124 -397 -174 -573 -121 l-43 13 84 83 84 84 66 4 c78 5 163 33 226 74 26 16 117 100 202 187 173 175 207 229 230 357 52 299 -224 576 -524 527 -130 -22 -184 -56 -360 -230 -87 -85 -172 -177 -188 -203 -39 -61 -68 -154 -73 -230 l-3 -59 -84 -85 -84 -85 -13 43 c-53 176 -3 410 121 573 57 76 306 321 370 364 156 106 341 144 522 106z m-32 -413 c92 -41 151 -133 151 -237 0 -97 -26 -140 -176 -292 -73 -73 -135 -133 -139 -133 -4 0 -7 24 -6 53 1 71 -18 133 -59 189 -58 80 -139 120 -244 119 -33 0 -60 3 -60 7 0 13 263 268 290 282 81 43 164 47 243 12z m-399 -529 c29 -28 35 -55 24 -98 -11 -42 -841 -872 -883 -883 -42 -11 -70 -4 -99 25 -29 28 -35 55 -24 98 11 42 841 872 883 883 42 11 70 4 99 -25z m-856 -375 l43 -13 -84 -83 -84 -84 -66 -4 c-78 -5 -163 -33 -226 -74 -26 -16 -117 -100 -202 -187 -173 -175 -207 -229 -230 -357 -52 -299 224 -576 524 -527 130 22 184 56 360 230 87 85 172 177 188 203 39 61 68 154 73 230 l3 59 84 85 84 85 13 -43 c53 -176 3 -410 -121 -573 -57 -76 -306 -321 -370 -364 -205 -140 -454 -159 -672 -52 -137 68 -237 168 -306 306 -113 228 -85 490 74 700 56 75 305 319 370 364 68 46 162 87 243 105 79 18 234 15 302 -6z m-331 -506 c-1 -176 133 -309 310 -305 29 1 53 -2 53 -6 0 -4 -60 -66 -133 -139 -152 -150 -195 -176 -292 -176 -146 0 -259 113 -259 259 0 97 26 140 176 292 73 73 135 133 139 133 4 0 7 -26 6 -58z"/> <path d="M1469 4031 c-38 -39 -40 -97 -5 -138 l24 -28 732 -3 732 -2 34 34 c37 37 43 70 20 115 -8 15 -26 32 -41 39 -19 9 -209 12 -746 12 l-721 0 -29 -29z"/> <path d="M731 3486 c-67 -37 -65 -143 4 -174 20 -9 296 -12 1131 -12 l1106 0 34 34 c50 50 42 121 -17 152 -40 20 -2221 21 -2258 0z"/> <path d="M51 2926 c-87 -48 -50 -186 49 -186 51 0 100 49 100 99 0 75 -83 124 -149 87z"/> <path d="M731 2926 c-67 -37 -65 -143 4 -174 19 -9 223 -12 810 -12 587 0 791 3 810 12 29 13 55 55 55 88 0 33 -26 75 -55 88 -40 18 -1591 16 -1624 -2z"/> <path d="M2734 2930 c-56 -22 -72 -108 -30 -157 24 -27 27 -28 145 -31 l121 -4 35 35 c38 38 44 70 21 116 -8 15 -26 32 -41 39 -30 14 -219 15 -251 2z"/> <path d="M731 2366 c-67 -37 -65 -143 4 -174 38 -18 2049 -17 2085 1 14 7 33 29 43 49 16 33 16 40 4 71 -31 72 53 67 -1087 67 -832 -1 -1030 -3 -1049 -14z"/> <path d="M731 1806 c-68 -38 -64 -146 6 -175 21 -8 141 -11 437 -9 l408 3 24 28 c33 38 33 96 0 134 l-24 28 -414 2 c-330 2 -418 0 -437 -11z"/> </g> </svg>
                            </a>
                        </ng-container>
                    </div>
                </td>
            </ng-container>
        
        
            <ng-container matColumnDef="detailIndicator">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Detalle</th>
                <td mat-cell *matCellDef="let element">
                    <mat-icon *ngIf="!element.selected && element.status != '8Rechazada' && element.status != '9Aprobada' ">keyboard_arrow_down</mat-icon>
                    <mat-icon *ngIf="element.selected && element.status != '8Rechazada' && element.status != '9Aprobada' ">keyboard_arrow_up</mat-icon>
                </td>
            </ng-container>
        


            <ng-container matColumnDef="expandedDetail">
                <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
                <div class="example-element-detail" [@detailExpand]="element.selected ? 'expanded' : 'collapsed'">
                    <div class="table-border-rounded">

                        <table class="sac-request-cross__sub-table" *ngIf="element.status == '1Creada' && element.requestInfoForDetail.length > 0 ">
                            <thead>
                                <tr>
                                    <th class="sac-request-cross__table-header-item sac-request-cross__table-body-item__darken"> <strong>Campo</strong></th>
                                    <th class="sac-request-cross__table-header-item sac-request-cross__table-body-item__darken"><strong>Valor Anterior</strong></th>
                                    <th class="sac-request-cross__table-header-item sac-request-cross__table-body-item__darken"><strong>Valor Nuevo</strong></th>
                                    <th class="sac-request-cross__table-header-item sac-request-cross__table-body-item__darken"><strong>Modificado Por</strong></th>
                                </tr>

                                <tr>
                                    <th>
                                    <hr>
                                    </th>
                                    <th>
                                    <hr>
                                    </th>
                                    <th>
                                    <hr>
                                    </th>
                                    <th>
                                    <hr>
                                    </th>
                                </tr>

                                <tr>
                                    <th class="sac-request-cross__table-space_min"></th>
                                </tr>
                            </thead>
                            <tbody>

                                <tr class="credits" *ngFor="let request of element.requestInfoForDetail">
                                    <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined">{{ getValueForKey(request.fieldName) }}</td>
                                    <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined">{{ request.oldValue }}</td>
                                    <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined">{{ request.newValue }}</td>
                                    <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined">{{ element.modifiedByUser}}</td>
                                </tr>

                                <tr>
                                    <th class="sac-request-cross__table-space_min"></th>
                                </tr>

                            </tbody>
                        </table>
                        <div *ngIf="element.status == '1Creada'" class="botton-actions">
                            <button (click)="openDialog(element, 0)" mat-flat-button  class="services-confirm__cancel-button">{{ getMessageToBotton(element, 0) }}</button>
                            <button (click)="openDialog(element, 1)" mat-raised-button color="primary" class="botton-actions__confirm customer-message-agreement-dialog__action">{{ getMessageToBotton(element, 1) }}</button>
                        </div>


                        <table class="sac-request-cross__sub-table" *ngIf="element.status == '1CambioAprobado' && element.requestInfoForDetail.length > 0 "> 
                            <thead>
                            <tr>
                                <th class="sac-request-cross__table-header-item sac-request-cross__table-body-item__darken"><strong>Campo Modificado</strong></th>
                                <th class="sac-request-cross__table-header-item sac-request-cross__table-body-item__darken"><strong>Valor</strong></th>
                                <th class="sac-request-cross__table-header-item sac-request-cross__table-body-item__darken"></th>
                            </tr>

                            <tr>
                                <th>
                                <hr>
                                </th>
                                <th>
                                <hr>
                                </th>
                            </tr>

                            <tr>
                                <th class="sac-request-cross__table-space_min"></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="credits" *ngFor="let request of element.requestInfoForDetail">
                                <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined">{{ getValueForKey(request.fieldName)}}</td>
                                <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined">{{ request.newValue }}</td>
                            </tr>
                            
                            <tr class="credits">
                                <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined"></td>
                                <td class="sac-request-cross__table-body-item sac-request-cross__table-body-item__darken sac-request-cross__table-body-outlined"></td>
                            </tr>

                            <tr>
                                <th class="sac-request-cross__table-space_min"></th>
                            </tr>
                            </tbody>
                        </table>
                        <div *ngIf="element.status == '1CambioAprobado'" class="botton-actions">
                            <button 
                                (click)="openDialog(element, 1)" 
                                mat-flat-button 
                                class="services-confirm__cancel-button botton-actions__confirm_sap sac-request__field-button customer-message-agreement-dialog__action">
                                Cambios Aplicados SAP
                            </button>
                        </div>
                    
                    </div>
                </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="example-element-row" [class.example-expanded-row]="row.selected" (click)="toggleRow(row)"></tr>
            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
        </table>
            
    </div>

</div>