<mat-card class="service-create-hbl-form">
    <mat-card-content>
        <form [formGroup]="createHblFormGroup">
            <div class="service-create-hbl-form__group-1">
                <mat-form-field>
                  <mat-label>BL Hijo</mat-label>

                  <input matInput formControlName="blChild" type="text">

                  <mat-error class="form-error" *ngIf="createHblFormGroup.controls['blChild'].errors && createHblFormGroup.controls['blChild'].errors['required']">
                    <mat-icon>close</mat-icon>
                    Campo Requerido
                  </mat-error>

                  <mat-error class="form-error" *ngIf="createHblFormGroup.controls['blChild'].errors && (createHblFormGroup.controls['blChild'].errors['minLength'] || createHblFormGroup.controls['blChild'].errors['maxlength'])">
                      <mat-icon>close</mat-icon>
                      Campo Invalido
                  </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Número de Documento</mat-label>

                    <input matInput formControlName="documentNumber" type="text">

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['documentNumber'].errors && createHblFormGroup.controls['documentNumber'].errors['required']">
                      <mat-icon>close</mat-icon>
                      Campo Requerido
                    </mat-error>

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['documentNumber'].errors && (createHblFormGroup.controls['documentNumber'].errors['min'] || createHblFormGroup.controls['documentNumber'].errors['max'])">
                        <mat-icon>close</mat-icon>
                        Del 11660000000000 al 116699999999999
                    </mat-error>
                </mat-form-field>
            </div>

            <app-customer-searcher class="service-create-hbl-form__customer-input" (customerControl)="onCustomerControlChange($event)"></app-customer-searcher>

            <div class="service-create-hbl-form__group-2">
                <mat-form-field>
                    <mat-label>Tipo de Empaque</mat-label>

                    <mat-select formControlName="packageType">
                        <mat-option [value]="packageType" *ngFor="let packageType of (servicesStore | async)">{{ packageType.description }}</mat-option>
                    </mat-select>

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['packageType'].errors && createHblFormGroup.controls['packageType'].errors['required']">
                      <mat-icon>close</mat-icon>
                      Campo Requerido
                    </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Cantidad</mat-label>

                    <input matInput formControlName="quantity" type="text">

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['quantity'].errors && createHblFormGroup.controls['quantity'].errors['required']">
                      <mat-icon>close</mat-icon>
                      Campo Requerido
                    </mat-error>

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['quantity'].errors && (createHblFormGroup.controls['quantity'].errors['min'] || createHblFormGroup.controls['quantity'].errors['max'])">
                        <mat-icon>close</mat-icon>
                        Campo Invalido
                    </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Peso</mat-label>

                    <input matInput formControlName="weight" type="text">

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['weight'].errors && createHblFormGroup.controls['weight'].errors['required']">
                      <mat-icon>close</mat-icon>
                      Campo Requerido
                    </mat-error>

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['weight'].errors && (createHblFormGroup.controls['weight'].errors['min'] || createHblFormGroup.controls['weight'].errors['max'])">
                        <mat-icon>close</mat-icon>
                        Campo Invalido
                    </mat-error>
                </mat-form-field>

                <mat-checkbox color="primary" [formControl]="createHblDangerousFormControl">
                    Contiene mercancia peligrosa
                </mat-checkbox>
            </div>

            <div class="service-create-hbl-form__group-3">
                <div class="service-create-hbl-form__number-un">
                    <mat-form-field>
                        <mat-label>Número UN</mat-label>

                        <input matInput formControlName="numberUN" type="text">

                        <mat-error class="form-error" *ngIf="createHblFormGroup.controls['numberUN'].errors && createHblFormGroup.controls['numberUN'].errors['required']">
                          <mat-icon>close</mat-icon>
                          Campo Requerido
                        </mat-error>

                        <mat-error class="form-error" *ngIf="createHblFormGroup.controls['numberUN'].errors && (createHblFormGroup.controls['numberUN'].errors['min'] || createHblFormGroup.controls['numberUN'].errors['max'])">
                            <mat-icon>close</mat-icon>
                            Campo Invalido
                        </mat-error>
                    </mat-form-field>

                    <button (click)="clean()" class="search-field__action search-field__delete-button">
                        <mat-icon>delete</mat-icon>
                    </button>

                    <button (click)="submitNumberUN()" class="search-field__action search-field__search-button">
                        <mat-icon>search</mat-icon>
                    </button>
                </div>

                <mat-form-field>
                    <mat-label>Clasificación IMO</mat-label>

                    <input matInput formControlName="IMOClassification" type="text">

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['IMOClassification'].errors && createHblFormGroup.controls['IMOClassification'].errors['required']">
                      <mat-icon>close</mat-icon>
                      Campo Requerido
                    </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Nombre IMO</mat-label>

                    <input matInput formControlName="IMOName" type="text">

                    <mat-error class="form-error" *ngIf="createHblFormGroup.controls['IMOName'].errors && createHblFormGroup.controls['IMOName'].errors['required']">
                      <mat-icon>close</mat-icon>
                      Campo Requerido
                    </mat-error>
                </mat-form-field>
            </div>
        </form>

        <div class="services-create-hbl-form__container-list">
            <div class="example-container">
                <h2>Contenedores</h2>

                <div
                    cdkDropList
                    #todoList="cdkDropList"
                    [cdkDropListData]="containers"
                    [cdkDropListConnectedTo]="[doneList]"
                    class="example-list"
                    (cdkDropListDropped)="drop($event)">
                    <div class="example-box" *ngFor="let item of containers" cdkDrag>{{item}}</div>
                </div>
            </div>

            <div class="example-container">
                <h2>Contenedores Incluidos</h2>

                <div
                    cdkDropList
                    #doneList="cdkDropList"
                    [cdkDropListData]="selectedContainer"
                    [cdkDropListConnectedTo]="[todoList]"
                    class="example-list"
                    (cdkDropListDropped)="drop($event)">
                    <div class="example-box" *ngFor="let item of selectedContainer" cdkDrag>{{item}}</div>
                </div>
            </div>
        </div>

        <div class="services-create-hbl-form__actions">
            <button mat-flat-button class="services-create-hbl-form__cancel-button" (click)="cancel()">Cancelar</button>
            <ng-container *permissions="[privileges.SERV_CRE_HBL]">
              <button
                mat-raised-button
                color="primary"
                [disabled]="createHblFormGroup.invalid || !(selectedContainer.length > 0) || !customerValid"
                [appDoubleFactorAuthentication]="'SERV_CRE_HBL'"
                [appDoubleFactorAPIGateway]="user"
                [doubleFactorCallback]="submit.bind(this)"
                [doubleFactorIncorrectCallback]="cancel.bind(this)"
                class="services-create-hbl-form__accept-button"
              >Crear</button>
            </ng-container>
        </div>
    </mat-card-content>
</mat-card>
